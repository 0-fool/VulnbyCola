# TOTOLink Vulnerability

Vendor:TOTOLink 

Product:LR350

Version:V9.3.5u.6369_B20220309(https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/231/ids/36.html)

Vulnerability Type: Stack Overflow

Author:Chuanhao Wan





## Vulnerability cause

In the sub_426EF8 function, the http_host parameter is obtained via websGetVar(Object, "http_host", (int)&byte_431160) and, when *v8 is non-empty, passed to the strcpy function, copying to the target buffer v30. The strcpy function does not restrict the length of the input v8 (i.e., http_host), and the target buffer v30 is a fixed-size array (char v30[256]). When the http_host parameter is excessively long (exceeding 255 bytes, accounting for the null terminator), strcpy(v30, v8) can trigger a buffer overflow, overwriting adjacent stack data or the return address, resulting in a Denial of Service (DoS) attack.

<div  align="center"><img src="./images/1.png" style="zoom:60%;" /></div>



## Result

The target router crashes and cannot provide services correctly and persistently.

<div  align="center"><img src="./images/2.png" style="zoom:80%;" /></div>