# TOTOLink Vulnerability

Vendor:TOTOLink 

Product:A7000R

Version:V9.1.0u.6115_B20201022(https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/171/ids/36.html)

Vulnerability Type: Stack Overflow

Author:Shuhao Shen





## Vulnerability cause

In the sub_422C30 function, the ssid5g parameter is obtained via websGetVar(a1, "ssid5g", &byte_431360) and passed to the urldecode function for decoding. The urldecode function stores the decoded input in the target buffer v68, but does not restrict the length of the input v59 (i.e., ssid5g). The urldecode function uses a pointer v3 (pointing to v68) to write decoded data byte by byte, with v4 (a counter) controlling the position of the null terminator, ultimately writing a null character at a2[v4 - 1] = 0. The target buffer v68 is a fixed-size array (_BYTE v68[128]), and the call to urldecode(v59, v68) is executed unconditionally. When the ssid5g parameter is excessively long, urldecode can trigger a buffer overflow, overwriting adjacent stack data or the return address, resulting in a Denial of Service (DoS) attack.


<div  align="center"><img src="./images/1.png" style="zoom:60%;" /></div>

<div  align="center"><img src="./images/2.png" style="zoom:80%;" /></div>




## Result

The target router crashes and cannot provide services correctly and persistently.

<div  align="center"><img src="./images/3.png" style="zoom:80%;" /></div>